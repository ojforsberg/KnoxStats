% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/overlay.R
\name{overlay}
\alias{overlay}
\title{Overlay a Probability Distribution on a Histogram}
\usage{
overlay(
  x,
  dist = "norm",
  na.rm = TRUE,
  breaks = "Sturges",
  from = NA,
  to = NA,
  length = 10000,
  xlim = NA,
  ylim = NA,
  col = "dodgerblue",
  fill = "aliceblue",
  rug = FALSE,
  onTop = FALSE,
  yaxs = "i",
  las = 1,
  xlab = "The Variable",
  ylab = "",
  main = "",
  maxDF = 1000,
  ...
)
}
\arguments{
\item{x}{A numeric vector of data values.}

\item{dist}{Character string specifying the distribution to overlay.
Options include: "norm" (normal), "exp" (exponential), "t" (Student's t),
"chisq" (chi-square), "gamma" (gamma), "cauchy" (Cauchy), or "unif" (uniform).
Default is "norm".}

\item{na.rm}{Logical indicating whether to remove missing values. Default is TRUE.}

\item{breaks}{Method to determine histogram breaks. Can be a number, vector,
or character string like "Sturges" or "Scott". Default is "Sturges".}

\item{from, to}{Numeric values for the density curve range. If NA, calculated
automatically from data.}

\item{length}{Number of points for the density curve. Default is 10000.}

\item{xlim, ylim}{Limits for x and y axes. If NA, calculated automatically.}

\item{col}{Color for the density curve border. Default is "dodgerblue".}

\item{fill}{Color for the density curve fill. Default is "aliceblue".}

\item{rug}{Logical indicating whether to add a rug plot. Default is FALSE.}

\item{onTop}{Logical indicating whether the density should be plotted on top
of the histogram. Default is FALSE.}

\item{yaxs}{Character indicating y-axis style. "i" for internal, "r" for regular.
Default is "i".}

\item{las}{Orientation of axis labels (0=parallel, 1=horizontal, 2=perpendicular,
3=vertical). Default is 1.}

\item{xlab}{Label for x-axis. Default is "The Variable".}

\item{ylab}{Label for y-axis. Default is empty.}

\item{main}{Main title for the plot. Default is empty.}

\item{maxDF}{Maximum degrees of freedom to consider for t and chi-square
distributions. Default is 1000.}

\item{...}{Additional graphical parameters passed to plotting functions.}
}
\value{
A named list containing the estimated parameters for the selected distribution.
}
\description{
Creates a histogram of data with an overlaid probability density curve.
This visualization helps compare empirical data distribution with theoretical
probability distributions. The function estimates distribution parameters
from the data using method of moments or maximum likelihood.
}
\details{
This function helps visualize how well different probability distributions
fit your data. It creates a histogram (showing the empirical distribution)
and overlays a smooth curve showing the theoretical probability density
function.

The function estimates distribution parameters from your data:
\itemize{
\item For normal distribution: mean and standard deviation
\item For exponential distribution: rate parameter (1/mean)
\item For t-distribution: degrees of freedom (estimated by maximum likelihood)
\item For chi-square distribution: degrees of freedom (estimated by maximum likelihood)
\item For gamma distribution: shape and rate parameters (method of moments)
\item For Cauchy distribution: location (median) and scale (IQR/2)
\item For uniform distribution: minimum and maximum values
}

The histogram uses a special styling with white separator lines in bars
when counts are low, making it easier to see individual observations.
}
\examples{
# Example 1: Normal distribution overlay
set.seed(123)
normal_data <- rnorm(100, mean = 50, sd = 10)
overlay(normal_data, dist = "norm", 
        main = "Normal Distribution Fit",
        xlab = "Test Scores")

# Example 2: Exponential distribution
exp_data <- rexp(50, rate = 0.5)
overlay(exp_data, dist = "exp",
        col = "darkred", fill = "pink",
        main = "Exponential Distribution Fit")

# Example 3: With rug plot and custom colors
t_data <- rt(80, df = 5)
overlay(t_data, dist = "t",
        rug = TRUE, col = "darkgreen", fill = "lightgreen",
        xlab = "t-distributed Values")

# Example 4: Compare multiple distributions
par(mfrow = c(2, 2))
overlay(normal_data, dist = "norm", main = "Normal")
overlay(normal_data, dist = "t", main = "t-distribution")
overlay(exp_data, dist = "exp", main = "Exponential")
overlay(exp_data, dist = "gamma", main = "Gamma")
par(mfrow = c(1, 1))

# Example 5: Custom histogram breaks
overlay(normal_data, breaks = 20, 
        col = "purple", fill = "lavender",
        main = "Custom Breaks (n=20)")

}
\references{
Rice, John A. 2007. \emph{Mathematical Statistics and Data Analysis}. 3rd ed.
Belmont, CA: Thomson Brooks/Cole.

Devore, Jay L. 2011. \emph{Probability and Statistics for Engineering and the
Sciences}. 8th ed. Boston, MA: Cengage Learning.

Wilks, Daniel S. 2011. \emph{Statistical Methods in the Atmospheric Sciences}.
3rd ed. Amsterdam: Academic Press.
}
\seealso{
\code{\link{hist}} for creating histograms,
\code{\link{dnorm}}, \code{\link{dexp}}, \code{\link{dt}} for density functions,
\code{\link{rug}} for adding rug plots,
\code{\link{par}} for graphical parameters
}
