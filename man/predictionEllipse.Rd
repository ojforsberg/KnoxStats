% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/predictionEllipse.R
\name{predictionEllipse}
\alias{predictionEllipse}
\title{Prediction Ellipse for Multivariate Linear Regression}
\usage{
predictionEllipse(mod, newdata, conf.level = 0.95, ...)
}
\arguments{
\item{mod}{An object of class \code{lm} (linear model) from a multivariate
regression with at least 2 response variables. Must be created using
\code{\link{lm}} with a matrix response.}

\item{newdata}{A data frame containing the predictor values for which to
create the prediction ellipse. Must have the same predictor variables as
the original model.}

\item{conf.level}{Confidence level for the prediction ellipse (default = 0.95).
Must be between 0 and 1.}

\item{...}{Additional graphical parameters passed to \code{\link{plot}}.}
}
\value{
Invisibly returns a matrix of (x, y) coordinates that define the ellipse
boundary. Primarily used for its side effect of creating a plot.
}
\description{
Creates a prediction ellipse (confidence region) for a bivariate response
from a multivariate linear regression model. The ellipse shows where future
observations are likely to fall with a specified confidence level.
}
\details{
This function creates a prediction ellipse for bivariate response data
from a multivariate linear regression. Unlike confidence intervals for
single variables, this ellipse accounts for the correlation between two
response variables.

The ellipse is centered at the predicted values for the given predictor
values, and its size and shape are determined by:
\enumerate{
\item{The prediction uncertainty (how well we can predict)}
\item{The correlation between the two response variables}
\item{The sample size and model complexity}
\item{The specified confidence level}
}

The mathematical basis is Hotelling's T-squared distribution, which is the
multivariate extension of the t-distribution. The red point in the center
shows the predicted values for the given predictor combination.
}
\examples{
\dontrun{
# Example 1: Basic usage with simulated data
# Create a multivariate response (two outcome variables)
set.seed(123)
n <- 50
x <- rnorm(n)
y1 <- 2 + 1.5*x + rnorm(n, sd = 0.5)
y2 <- 1 + 0.8*x + rnorm(n, sd = 0.7)

# Response matrix (both y1 and y2 together)
Y <- cbind(y1, y2)

# Fit multivariate regression
mod <- lm(Y ~ x)

# Create prediction ellipse for x = 0.5
newdata <- data.frame(x = 0.5)
predictionEllipse(mod, newdata)

# Example 2: With multiple predictors
data <- data.frame(
  x1 = rnorm(40),
  x2 = rnorm(40),
  y1 = rnorm(40),
  y2 = rnorm(40)
)
Y <- cbind(data$y1, data$y2)
mod2 <- lm(Y ~ x1 + x2, data = data)

# Predict for specific values
newdata2 <- data.frame(x1 = 0, x2 = 0)
predictionEllipse(mod2, newdata2, conf.level = 0.90,
                  main = "90\% Prediction Ellipse",
                  col = "blue", lwd = 2)

# Example 3: Add observed data points
plot(data$y1, data$y2, pch = 16, col = "gray",
     xlab = "Response 1", ylab = "Response 2",
     main = "Data with Prediction Ellipse")
predictionEllipse(mod2, newdata2, add = TRUE)
points(newdata2$x1, newdata2$x2, pch = 19, col = "red", cex = 1.5)
}

}
\references{
Fox, John, and Sanford Weisberg. 2019. \emph{An R Companion to Applied Regression}.
3rd ed. Thousand Oaks, CA: Sage. https://socialsciences.mcmaster.ca/jfox/Books/Companion/.

Johnson, Richard A., and Dean W. Wichern. 2007. \emph{Applied Multivariate
Statistical Analysis}. 6th ed. Upper Saddle River, NJ: Pearson Prentice Hall.

Hotelling, Harold. 1931. "The Generalization of Student's Ratio." \emph{Annals of
Mathematical Statistics} 2 (3): 360â€“78. https://doi.org/10.1214/aoms/1177732979.
}
\seealso{
\code{\link{lm}} for fitting linear models (with matrix responses),
\code{\link[car]{ellipse}} for generating ellipse coordinates,
\code{\link{predict.lm}} for making predictions from linear models,
\code{\link{confint}} for confidence intervals in univariate regression
}
