% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/HLgof.R
\name{HLgof}
\alias{HLgof}
\title{Hosmer-Lemeshow Goodness-of-Fit Test}
\usage{
HLgof(y, yhat, g = 10)
}
\arguments{
\item{y}{A numeric vector of observed binary outcomes (0 or 1).}

\item{yhat}{A numeric vector of predicted probabilities from a logistic
regression model (values between 0 and 1).}

\item{g}{Integer specifying the number of groups to create based on predicted
probabilities (default is 10). Must be at least 3.}
}
\value{
An object of class \code{"htest"} containing:
\item{statistic}{The Hosmer-Lemeshow chi-square test statistic (H)}
\item{parameter}{Degrees of freedom (g - 2)}
\item{p.value}{The p-value for the test}
\item{method}{A character string describing the test}
\item{data.name}{A character string giving the name of the data}
\item{alternative}{A character string describing the alternative hypothesis}
}
\description{
Performs the Hosmer-Lemeshow goodness-of-fit test for logistic regression models.
This test assesses whether the observed event rates in subgroups match the
expected event rates predicted by the model.
}
\details{
The Hosmer-Lemeshow test is commonly used to assess the calibration of
logistic regression models. The test works by:
\enumerate{
\item Sorting observations by their predicted probabilities (\code{yhat})
\item Dividing them into \code{g} groups (usually 10) based on quantiles
\item Comparing observed vs. expected outcomes in each group using a chi-square test
}

A small p-value (typically < 0.05) suggests that the model doesn't fit the
data well. However, the test has limitations:

\itemize{
\item It's sensitive to the choice of \code{g} (number of groups)
\item It assumes no group has fewer than 5 observations
\item It works best with large sample sizes
\item It may have low power to detect certain types of misfit
}

The test statistic follows a chi-square distribution with \code{g - 2} degrees
of freedom under the null hypothesis that the model fits the data.
}
\examples{
# Simulate some data for a logistic regression example
set.seed(123)
n <- 200
x1 <- rnorm(n)
x2 <- rnorm(n)

# True logistic model
true_prob <- plogis(0.5 + 0.8*x1 - 0.4*x2)
y <- rbinom(n, 1, true_prob)

# Fit a logistic regression model
model <- glm(y ~ x1 + x2, family = binomial)

# Get predicted probabilities
predicted_probs <- predict(model, type = "response")

# Perform Hosmer-Lemeshow test with default (10 groups)
HLgof(y, predicted_probs)

# Try with fewer groups (e.g., 5)
HLgof(y, predicted_probs, g = 5)

# Example with poorly fitting model
bad_model <- glm(y ~ 1, family = binomial)  # Null model
bad_probs <- predict(bad_model, type = "response")
HLgof(y, bad_probs)

# Note: The test may warn about small bin sizes
# with too many groups for small datasets
small_data_y <- y[1:30]
small_data_probs <- predicted_probs[1:30]
\dontrun{
HLgof(small_data_y, small_data_probs, g = 10)  # May produce warning
}

}
\references{
Hosmer, David W., and Stanley Lemeshow. 1980. "Goodness-of-Fit Tests for
the Multiple Logistic Regression Model." \emph{Communications in Statistics:
Theory and Methods} 9 (10): 1043–69.

Hosmer, David W., Stanley Lemeshow, and Rodney X. Sturdivant. 2013. \emph{Applied
Logistic Regression}. 3rd ed. Hoboken, NJ: John Wiley & Sons.

Paul, Pranab, Tathagata Banerjee, and Arnab Kumar Maity. 2021. "A Critical
Review of the Hosmer-Lemeshow Test." \emph{International Journal of Epidemiology}
50 (4): 1077–84. doi:10.1093/ije/dyab049.
}
\seealso{
\code{\link[stats]{glm}} for fitting logistic regression models,
\code{\link[stats]{pchisq}} for the chi-square distribution function,
\code{\link[stats]{quantile}} for creating the groups,
\code{\link[stats]{xtabs}} for creating contingency tables
}
