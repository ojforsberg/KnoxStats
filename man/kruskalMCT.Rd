% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/kruskalMCT.R
\name{kruskalMCT}
\alias{kruskalMCT}
\title{Kruskal-Wallis Multiple Comparison Test}
\usage{
kruskalMCT(x, g, conf.level = 0.95, p.adjust.method = "BH")
}
\arguments{
\item{x}{A numeric vector of response values (measurement variable).}

\item{g}{A factor or vector coercible to factor, representing the grouping variable.}

\item{conf.level}{Confidence level for the interval estimates. Default is 0.95.}

\item{p.adjust.method}{Method for adjusting p-values for multiple comparisons.
See \code{\link{p.adjust}} for available methods. Default is "BH" (Benjamini-Hochberg).}
}
\value{
An object of class \code{"pairwise.htest"} containing:
\itemize{
\item \code{method}: Description of the test
\item \code{data.name}: Names of the data
\item \code{p.value}: Matrix of adjusted p-values
\item \code{p.adjust.method}: Method used for p-value adjustment
\item \code{conf.level}: Confidence level used
}
}
\description{
Performs pairwise Wilcoxon rank sum tests (Mann-Whitney U tests) with p-value
adjustment for multiple comparisons, following a significant Kruskal-Wallis test.
}
\details{
This function performs post-hoc pairwise comparisons after a significant
Kruskal-Wallis test to identify which specific group differences are
statistically significant. It is essentially a wrapper around
\code{\link{pairwise.wilcox.test}} that includes a warning message reminding
users that these tests should only be interpreted when the omnibus
Kruskal-Wallis test is significant.

The function uses Wilcoxon rank sum tests (equivalent to Mann-Whitney U tests)
for each pair of groups, with p-values adjusted to control the family-wise
error rate or false discovery rate, depending on the chosen adjustment method.
}
\section{Important Note}{

These post-hoc tests are only meaningful when the initial Kruskal-Wallis test
has been performed and yielded a significant result (typically p < 0.05).
Performing multiple comparisons without a significant omnibus test increases
the risk of Type I errors (false positives).
}

\examples{
# Example 1: Basic usage
data(iris)

# First, perform Kruskal-Wallis test
kruskal_result <- kruskal.test(Sepal.Length ~ Species, data = iris)
print(kruskal_result)

# Only proceed if Kruskal-Wallis is significant (p < 0.05)
if (kruskal_result$p.value < 0.05) {
  # Perform multiple comparisons
  posthoc <- kruskalMCT(
    x = iris$Sepal.Length,
    g = iris$Species,
    p.adjust.method = "holm"
  )
  print(posthoc)
}

# Example 2: Using different adjustment methods
if (kruskal_result$p.value < 0.05) {
  # Benjamini-Hochberg (default) - controls false discovery rate
  posthoc_bh <- kruskalMCT(iris$Sepal.Length, iris$Species, p.adjust.method = "BH")
  
  # Holm method - more conservative, controls family-wise error rate
  posthoc_holm <- kruskalMCT(iris$Sepal.Length, iris$Species, p.adjust.method = "holm")
  
  # Bonferroni - most conservative
  posthoc_bonf <- kruskalMCT(iris$Sepal.Length, iris$Species, p.adjust.method = "bonferroni")
}

# Example 3: Custom dataset
set.seed(123)
treatment <- factor(rep(c("A", "B", "C", "D"), each = 10))
response <- c(
  rnorm(10, mean = 5, sd = 1),
  rnorm(10, mean = 6, sd = 1),
  rnorm(10, mean = 7, sd = 1),
  rnorm(10, mean = 8, sd = 1)
)

# Check Kruskal-Wallis first
kw_test <- kruskal.test(response ~ treatment)
print(kw_test)

# If significant, run multiple comparisons
if (kw_test$p.value < 0.05) {
  posthoc_results <- kruskalMCT(
    x = response,
    g = treatment,
    conf.level = 0.99,
    p.adjust.method = "BH"
  )
  print(posthoc_results)
}

}
\references{
\itemize{
\item{Kruskal, W. H., & Wallis, W. A. (1952). Use of ranks in one-criterion
variance analysis. Journal of the American Statistical Association,
47(260), 583-621.}
\item{Benjamini, Y., & Hochberg, Y. (1995). Controlling the false discovery
rate: a practical and powerful approach to multiple testing. Journal
of the Royal Statistical Society: Series B (Methodological), 57(1),
289-300.}
\item{Holm, S. (1979). A simple sequentially rejective multiple test
procedure. Scandinavian Journal of Statistics, 6(2), 65-70.}
}
}
\seealso{
\code{\link{kruskal.test}} for the Kruskal-Wallis omnibus test,
\code{\link{pairwise.wilcox.test}} for the underlying test function,
\code{\link{p.adjust}} for p-value adjustment methods,
\code{\link{wilcox.test}} for the two-sample Wilcoxon rank sum test
}
